@{
    ViewData["Title"] = "گزارش فروش و پرداخت‌ها";
}

<div class="container mt-4">
    <h2 class="text-center">📊 گزارش فروش و پرداخت‌های مشتریان</h2>

    <div class="row">
        <!-- فرم جستجوی محصولات -->
        <div class="col-md-6">
            <div class="card shadow p-3">
                <h5>🔍 جستجوی محصول</h5>
                <form id="searchProductForm">
                    <input type="text" id="productSearchInput" class="form-control mb-2" placeholder="نام محصول را وارد کنید">
                    <button type="submit" class="btn btn-primary w-100">جستجو</button>
                </form>
                <div id="productReportResult" class="mt-3"></div>
            </div>
        </div>

        <!-- فرم جستجوی مشتری -->
        <div class="col-md-6">
            <div class="card shadow p-3">
                <h5>🔍 جستجوی مشتری</h5>
                <form id="searchCustomerForm">
                    <input type="text" id="customerSearchInput" class="form-control mb-2" placeholder="نام مشتری را وارد کنید">
                    <button type="submit" class="btn btn-success w-100">جستجو</button>
                </form>
                <div id="customerReportResult" class="mt-3"></div>
            </div>
        </div>
    </div>
</div>

<!-- فقط یک بار jQuery بارگذاری شود -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        // جستجوی محصول
        $("#searchProductForm").submit(function (e) {
            e.preventDefault();
            let productName = $("#productSearchInput").val().trim();
            if (!productName) return alert("لطفاً نام محصول را وارد کنید.");

            $.get("/Sale/GetProductReport", { productName: productName })
                .done(function (response) {
                    $("#productReportResult").html(response);
                })
                .fail(function () {
                    $("#productReportResult").html('<div class="alert alert-danger">خطا در دریافت اطلاعات محصول</div>');
                });
        });

        // جستجوی مشتری
        $("#searchCustomerForm").submit(function (e) {
            e.preventDefault();
            let customerName = $("#customerSearchInput").val().trim();
            if (!customerName) return alert("لطفاً نام مشتری را وارد کنید.");

            $.get("/Sale/GetCustomerReport", { customerName: customerName })
                .done(function (response) {
                    $("#customerReportResult").html(response);
                })
                .fail(function () {
                    $("#customerReportResult").html('<div class="alert alert-danger">خطا در دریافت اطلاعات مشتری</div>');
                });
        });
    });
</script>